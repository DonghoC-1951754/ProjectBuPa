```{r setup, include=FALSE}
# load packages
library(ggplot2)
library(tidyr)
library(dplyr)
library(ggcorrplot)
library(tinytex)
library(stringr)
library(tidyverse)
library(pander)
library(lubridate)
library(mice)
library(plotly)
library(readr)
library(bupaR)
library(eventdataR)
library(xesreadR)
library(edeaR)
library(processmapR)
library(processmonitR)

#install.packages("bupaR")
#install.packages("eventdataR")
#install.packages("xesreadR")
#install.packages("edeaR")
#install.packages("processmapR")
#install.packages("processmonitR")

```

```{r}
# load data / source loadscript
data <- read_csv("data.csv")

```


```{r}
# bewerkingen data
data %>%
  group_by(`case GR-Based Inv. Verif.`) %>%
  summarise(aantal = n())

data %>%
  group_by(`case Goods Receipt`) %>%
  summarise(aantal = n())

data %>%
  group_by(`case Document Type`) %>%
  summarise(aantal = n())

data <- data %>%
  mutate(lifecycle_id = "complete")

```

```{r}
# event log building
data$`event time:timestamp` <- dmy_hms(data$`event time:timestamp`)

summary(data)

eventlog <- bupaR::simple_eventlog(eventlog = data, case_id = "case concept:name", activity_id = "event concept:name", timestamp = "event time:timestamp")

```

```{r}
#om de cornerstones te bekijken

cornerstones <- unique(data$`event concept:name`)
print(cornerstones)
```

```{r}
# Bekijken de key documents & tables
documents <- unique(data$`case Purch. Doc. Category name`)
print(documents)
```

```{r setup, include=FALSE}
# Exploratory analysis (Dongho)

# Remove special characters from raw data (activity_frequency() doesn't work on the original eventlog)
data_exploratory <- data
colnames(data_exploratory) <- gsub("[^[:alnum:]_]", "", colnames(data))

# Create simple_eventlog without special characters
eventlog_exploratory <- simple_eventlog(
  data_exploratory, 
  case_id = "caseconceptname",
  activity_id = "eventconceptname",
  timestamp = "eventtimetimestamp"
  )

# Activity frequency
eventlog_exploratory %>% activity_frequency(level = "activity")
eventlog_exploratory %>% activity_frequency(level = "trace")
eventlog_exploratory %>% activity_frequency(level = "case")
eventlog_exploratory %>% activity_frequency(level = "log")


```

